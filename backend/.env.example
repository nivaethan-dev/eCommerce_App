# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
HOST=0.0.0.0
PORT=10000
FRONTEND_URL=http://localhost:5173
VITE_API_URL=http://localhost:3000
NODE_ENV=production

# =============================================================================
# DATABASE
# =============================================================================
MONGODB_URI_DEV=mongodb+srv://username:password@cluster.mongodb.net/
MONGODB_URI_PROD=mongodb+srv://username:password@cluster.mongodb.net/

# =============================================================================
# JWT SECRETS (Generate with: openssl rand -hex 32)
# =============================================================================
CUSTOMER_JWT_SECRET=your_customer_jwt_secret_here
CUSTOMER_REFRESH_JWT_SECRET=your_customer_refresh_jwt_secret_here
ADMIN_JWT_SECRET=your_admin_jwt_secret_here
ADMIN_REFRESH_JWT_SECRET=your_admin_refresh_jwt_secret_here

# =============================================================================
# CLOUDINARY (Image Upload Service)
# =============================================================================
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret
SERVE_LOCAL_UPLOADS=false

# =============================================================================
# ADMIN ACCOUNT (Initial Setup)
# =============================================================================
ADMIN_NAME=AdminName
ADMIN_EMAIL=admin@example.com
ADMIN_PHONE=1234567890
ADMIN_PASSWORD=YourSecurePassword123!

# =============================================================================
# ACCOUNT LOCKOUT SETTINGS (Account-based - authController)
# =============================================================================
# After MAX_ATTEMPTS failed login attempts, the account is locked for LOCK_TIME
MAX_ATTEMPTS=5
LOCK_TIME=900000 # 15 minutes in milliseconds (15 * 60 * 1000)

# =============================================================================
# RATE LIMITING SETTINGS (IP-based - rateLimitMiddleware)
# =============================================================================

# Login Rate Limiting (IP + Email combination for better security)
LOGIN_MAX_ATTEMPTS=5
LOGIN_LOCK_TIME=900000 # 15 minutes (Should match LOCK_TIME for consistency)

# Registration Rate Limiting
REGISTER_MAX_ATTEMPTS=3
REGISTER_LOCK_TIME=3600000 # 1 hour

# Refresh Token Rate Limiting
REFRESH_TOKEN_WINDOW=60000 # 1 minute
REFRESH_TOKEN_MAX_ATTEMPTS=5

# Order Rate Limiting
ORDER_WINDOW=3600000 # 1 hour
ORDER_MAX_ATTEMPTS=5

# Cart Rate Limiting
CART_WINDOW=60000 # 1 minute
CART_MAX_ATTEMPTS=10

# Cart Modification Rate Limiting
CART_MODIFY_WINDOW=60000 # 1 minute
CART_MODIFY_MAX_ATTEMPTS=30

# Product Search Rate Limiting
PRODUCT_SEARCH_WINDOW=60000 # 1 minute
PRODUCT_SEARCH_MAX_ATTEMPTS=60

# Product Creation Rate Limiting
PRODUCT_CREATE_WINDOW=60000 # 1 minute
PRODUCT_CREATE_MAX_ATTEMPTS=5

# Product Modification Rate Limiting
PRODUCT_MODIFY_WINDOW=60000 # 1 minute
PRODUCT_MODIFY_MAX_ATTEMPTS=10

# Product Read Rate Limiting
PRODUCT_READ_WINDOW=60000 # 1 minute
PRODUCT_READ_MAX_ATTEMPTS=60

# Admin Read Rate Limiting
ADMIN_READ_WINDOW=60000 # 1 minute
ADMIN_READ_MAX_ATTEMPTS=30

# Notification Rate Limiting
NOTIFICATION_WINDOW=60000 # 1 minute
NOTIFICATION_MAX_ATTEMPTS=60

# =============================================================================
# NOTES ON RATE LIMITING
# =============================================================================
# - All time values are in milliseconds
# - LOGIN uses IP + email combination to prevent distributed attacks
# - REGISTER uses IP + email combination to prevent abuse
# - Account lockout (MAX_ATTEMPTS/LOCK_TIME) works per account
# - IP rate limiting works per IP or IP + email combination
# - Both mechanisms work together for defense in depth
# =============================================================================
